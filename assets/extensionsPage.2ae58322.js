import{Q as E}from"./QIntersection.6eec15bc.js";import{Q as I}from"./QList.ab68cd2b.js";import{Q}from"./QInnerLoading.c515810d.js";import{Q as b}from"./QPage.15fd8730.js";import{i as d}from"./models.d7e94ac2.js";import{g as N,Q as z}from"./usefull.2dc78a7a.js";import{Q as k,a as g}from"./QItemLabel.bc894da5.js";import{Q as F}from"./QBtn.239ac4bd.js";import{Q as B}from"./QItem.3b00e4c6.js";import{Q as A}from"./QCard.b23e52e7.js";import{d as C,r as y,_ as U,f as r,j as m,k as a,m as n,u as L,p as $,t as c,v as h,n as x,q as w,s as S,x as _,F as v}from"./index.e607ebbf.js";import{l as V}from"./language.588b8ace.js";import{u as j}from"./Filters.e0eb5b96.js";import"./Intersection.db333c73.js";import"./QSpinner.a066f13a.js";import"./use-dark.5a95c9ad.js";import"./use-transition.ff15bca0.js";import"./axios.adfc46d0.js";import"./StoreStuff.8dd7626e.js";import"./getenv.7492fdf7.js";import"./QIcon.872d3216.js";import"./Ripple.e079ce52.js";import"./dom.a3995931.js";const P=C({name:"ExtCard",props:{exten:{type:Object,required:!0}},emits:["reload"],setup(){return{imgdata:y("")}},computed:{UpUnIn(){return this.exten.hasUpdate?"Update":this.exten.installed?"Uninstall":"Install"}},mounted:function(){N(this.exten.iconUrl).then(t=>{this.imgdata=t})},methods:{capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)},async HandleExt(){this.exten.hasUpdate?await this.$api.get(`/api/v1/extension/update/${this.exten.pkgName}`):this.exten.installed?await this.$api.get(`/api/v1/extension/uninstall/${this.exten.pkgName}`):await this.$api.get(`/api/v1/extension/install/${this.exten.pkgName}`),this.$emit("reload")}}}),T={class:"row content-center col-grow"},G={key:0,style:{color:"red"}},H={class:"flex items-center"};function R(t,e,i,l,u,s){return r(),m(A,{class:w(["q-ma-sm",t.$q.dark.isActive?"":"bg-light"])},{default:a(()=>[n(B,{style:{height:"100px"}},{default:a(()=>[L("div",T,[n(k,{avatar:""},{default:a(()=>[n(z,{src:t.imgdata,loading:"lazy","spinner-color":"white",style:{height:"100px","aspect-ratio":"225/225",width:"fit-content"},class:"rounded-borders items-center justify-center","no-spinner":""},{default:a(()=>[n(Q,{showing:!t.imgdata,color:"primary",class:"bg-transparent"},null,8,["showing"])]),_:1},8,["src"])]),_:1}),n(k,{class:"flex-grow"},{default:a(()=>[n(g,null,{default:a(()=>[$(c(t.capitalizeFirstLetter(t.exten.name)),1)]),_:1}),n(g,{caption:""},{default:a(()=>[$(c(t.capitalizeFirstLetter(t.exten.lang))+" "+c(t.exten.versionName)+" ",1),t.exten.isNsfw?(r(),h("span",G,"18+")):x("",!0)]),_:1})]),_:1})]),L("div",H,[n(F,{outline:"",color:"blue",onClick:t.HandleExt},{default:a(()=>[n(g,{class:w(t.$q.dark.isActive?"light":"dark")},{default:a(()=>[$(c(t.capitalizeFirstLetter(t.UpUnIn)),1)]),_:1},8,["class"])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["class"])}var D=U(P,[["render",R]]);const O=C({name:"SourcesPage",components:{extCard:D},emits:["set-title"],setup(t,{emit:e}){e("set-title","Extentions");const i=j(),l=i,u=y([]),s=y(i.langs);return{list:u,allLangs:[],filters:l,langs:s}},computed:{langGroups(){return this.groupExtensions(this.list)},filterList(){let t=this.langGroups;return t=t.map(e=>{let i=e[1];return this.$route.query.q&&(i=i.filter(l=>l.name.toLowerCase().includes(`${this.$route.query.q}`.toLowerCase()))),this.langs.includes(e[0])||(i=[]),[e[0],i]}),t}},created:function(){this.reload()},methods:{myTweak(t){return{height:t?`calc(100vh - ${t}px)`:"100vh"}},reload(){this.$api.get("/api/v1/extension/list").then(({data:t})=>{this.list=t})},groupExtensions(t){this.allLangs=[];const e={installed:[],"updates pending":[]};t.forEach(s=>{var p;const o=s.lang;e[o]==null&&(e[o]=[],o!=="all"&&this.allLangs.push(o)),s.installed?s.hasUpdate?d(e["updates pending"])&&e["updates pending"].push(s):d(e.installed)&&e.installed.push(s):(p=e[o])==null||p.push(s)}),this.allLangs.sort(V);const i=[["updates pending",d(e["updates pending"])?e["updates pending"]:[]],["installed",d(e.installed)?e.installed:[]],["all",d(e.all)?e.all:[]]];this.filters.setcurrlangs(this.allLangs);const l=this.allLangs.map(s=>[s,e[s]]).filter(s=>s[1]!=null);return i.concat(l)},capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)}}}),J={key:0,class:"text-h4 q-ml-xl q-my-lg"};function K(t,e,i,l,u,s){const o=S("extCard");return r(),m(b,{"style-fn":t.myTweak},{default:a(()=>[(r(!0),h(v,null,_(t.filterList,p=>(r(),m(I,{key:p[0]},{default:a(()=>[p[1].length?(r(),h("div",J,c(t.capitalizeFirstLetter(p[0])),1)):x("",!0),(r(!0),h(v,null,_(p[1],(f,q)=>(r(),m(E,{key:q,style:{height:"100px",width:"100%"},class:"flex-shrink"},{default:a(()=>[!f.obsolete||f.installed?(r(),m(o,{key:0,exten:f,onReload:t.reload},null,8,["exten","onReload"])):x("",!0)]),_:2},1024))),128))]),_:2},1024))),128)),n(Q,{style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"fit-content",height:"fit-content","background-color":"transparent"},showing:t.filterList.length==3,color:"primary"},null,8,["showing"])]),_:1},8,["style-fn"])}var yt=U(O,[["render",K]]);export{yt as default};
