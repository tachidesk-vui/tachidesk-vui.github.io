import{storeGet as v}from"./StoreStuff.ce90795c.js";import{g as r}from"./getenv.7492fdf7.js";import{r as a}from"./index.1d2a11c1.js";const i=a(""),o=a(!1),m=v("baseUrl",r("TachideskURL")?r("TachideskURL"):location.origin),s=new URL(m);s.protocol=s.protocol=="https:"?"wss:":"ws:";let e;const l=n=>{i.value=n.data},c=()=>{console.log("Connected"),o.value=!0,e.addEventListener("message",l),e.addEventListener("close",t)},t=()=>{o.value=!1,e&&(console.error("Disconnected."),e.removeEventListener("message",l),e.removeEventListener("open",c),e.removeEventListener("close",t)),e=new WebSocket(`${s.href.slice(0,-1)}/api/v1/downloads`),e.addEventListener("open",c)};t();function g(){return{eventsFromServer:i,isConnected:o,sendMsg:d=>{e.send(d)}}}export{g as u};
