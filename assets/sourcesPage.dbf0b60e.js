import{Q as L}from"./QIntersection.ab9998e9.js";import{Q as S}from"./QList.6bfb0c71.js";import{Q}from"./QInnerLoading.ff2eb89c.js";import{Q as q}from"./QPage.4ea9bec4.js";import{a as $,u as B}from"./Filters.c18ccb6e.js";import{g as N,Q as T}from"./usefull.a3959d77.js";import{Q as g,a as f}from"./QItemLabel.fe033cca.js";import{Q as h}from"./QBtn.ef707184.js";import{Q as j}from"./QItem.23031f72.js";import{Q as F}from"./QCard.55927736.js";import{R}from"./Ripple.6a7e2b1e.js";import{storeGet as V}from"./StoreStuff.f22e8b45.js";import{d as _,r as u,_ as k,f as o,j as n,k as s,B as z,u as y,m as r,p as w,t as p,v as l,n as c,aj as P,s as U,x as A,F as D}from"./index.4ffe63ff.js";import"./Intersection.df177836.js";import"./QSpinner.1261b081.js";import"./use-dark.18af2aa7.js";import"./use-transition.3b0e28b8.js";import"./axios.7a39b714.js";import"./getenv.7492fdf7.js";import"./QIcon.27632acb.js";import"./dom.d506b434.js";const E=_({name:"SourceCard",props:{source:{type:Object,required:!0}},emits:["reload"],setup(){const e=u(`${V("useCache",!0)}`),t=u("");return{useCache:e,imgdata:t}},watch:{"source.iconUrl"(){this.imgdata="",this.getSetImg()}},mounted:function(){this.getSetImg()},methods:{capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)},langCodeToName:$,getSetImg(){N(this.source.iconUrl+"?useCache="+this.useCache).then(e=>{this.imgdata=e})}}}),x={class:"row content-center col-grow"},G={key:0,style:{color:"red"}},O={class:"flex items-center"};function H(e,t,a,m,d,C){return o(),n(F,{flat:"",class:"q-ma-sm"},{default:s(()=>[z((o(),n(j,{clickable:"",style:{height:"100px"},to:`/sources/${e.source.id}/popular/`},{default:s(()=>[y("div",x,[r(g,{avatar:""},{default:s(()=>[r(T,{src:e.imgdata,loading:"lazy","spinner-color":"white",style:{height:"100px","aspect-ratio":"225/225",width:"fit-content"},class:"rounded-borders items-center justify-center","no-spinner":""},{default:s(()=>[r(Q,{showing:!e.imgdata,color:"primary",class:"bg-transparent"},null,8,["showing"])]),_:1},8,["src"])]),_:1}),r(g,{class:"flex-grow"},{default:s(()=>[r(f,null,{default:s(()=>[w(p(e.capitalizeFirstLetter(e.source.name)),1)]),_:1}),r(f,{caption:""},{default:s(()=>[w(p(e.langCodeToName(e.source.lang))+" ",1),e.source.isNsfw?(o(),l("span",G,"18+")):c("",!0)]),_:1})]),_:1})]),y("div",O,[e.source.supportsLatest?(o(),n(h,{key:0,class:"q-ma-sm",outline:"",color:"blue",label:"latest",to:`/sources/${e.source.id}/latest/`},null,8,["to"])):c("",!0),e.$q.screen.xs?c("",!0):(o(),n(h,{key:1,class:"q-ma-sm",outline:"",color:"blue",label:"browse",to:`/sources/${e.source.id}/popular/`},null,8,["to"]))])]),_:1},8,["to"])),[[R]])]),_:1})}var J=k(E,[["render",H]]);const K=_({name:"SourcesPage",components:{sourcecard:J},emits:["set-title"],setup(e,{emit:t}){t("set-title","Sources");const a=B(),m=u(a.langs);return{list:u([]),langs:m,filters:a,is:P}},computed:{uselist(){return this.list.filter(t=>this.langs.includes(t.lang)).sort((t,a)=>t.lang<a.lang?1:t.lang>a.lang?-1:0)}},created:function(){this.reload()},methods:{myTweak(e){return{height:e?`calc(100vh - ${e}px)`:"100vh"}},reload(){this.$api.get("/api/v1/source/list").then(({data:e})=>{this.list=e,this.filters.setcurrlangs(this.extractLangs(e))})},langCodeToName:$,extractLangs(e){return Array.from(new Set(e.map(t=>t.lang)))}}}),M={key:0,class:"text-h4 q-ml-xl q-my-lg"};function W(e,t,a,m,d,C){const v=U("sourcecard");return o(),n(q,{"style-fn":e.myTweak},{default:s(()=>[r(S,null,{default:s(()=>[(o(!0),l(D,null,A(e.uselist,(i,b)=>(o(),l("div",{key:b},[e.is.deepEqual(e.uselist.find(I=>I.lang==i.lang),i)?(o(),l("div",M,p(e.langCodeToName(i.lang)),1)):c("",!0),r(L,{style:{height:"100px",width:"100%"},class:"flex-shrink"},{default:s(()=>[r(v,{source:i,onReload:e.reload},null,8,["source","onReload"])]),_:2},1024)]))),128))]),_:1}),r(Q,{style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"fit-content",height:"fit-content","background-color":"transparent"},showing:!e.uselist.length,color:"primary"},null,8,["showing"])]),_:1},8,["style-fn"])}var we=k(K,[["render",W]]);export{we as default};
