import{u as B,a as I}from"./use-dark.6a672a10.js";import{c as L,h as U}from"./QSpinner.5eed4aaf.js";import{c as v,h as z,g as N,d as w,r as g,_ as C,B as q,f as s,j as l,k as a,m as t,p as _,t as k,ai as P,n as T,s as D,v as h,x as Q,F as $,u as R}from"./index.0e613efa.js";import{Q as d,a as u}from"./QItemLabel.c44d9f45.js";import{Q as S}from"./QItem.bc55f9b3.js";import{Q as b}from"./QCard.0a761dda.js";import{Q as V}from"./QInfiniteScroll.8e6fd0fa.js";import{Q as j}from"./QPage.f024ecae.js";import{R as x}from"./Ripple.3ab13508.js";import{Q as A}from"./QInnerLoading.d2177515.js";import{g as F,Q as O}from"./usefull.376ae9d0.js";import{Q as E}from"./QBtn.d09c3270.js";import{storeGet as G}from"./StoreStuff.21e2f4bb.js";import"./dom.41615696.js";import"./scroll.924aa4d3.js";import"./use-transition.5dfc4757.js";import"./axios.3ffc132c.js";import"./getenv.7492fdf7.js";import"./QIcon.5f4d6aeb.js";const M=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],H=["wave","pulse","pulse-x","pulse-y","fade","blink","none"];var r=L({name:"QSkeleton",props:{...B,tag:{type:String,default:"div"},type:{type:String,validator:e=>M.includes(e),default:"rect"},animation:{type:String,validator:e=>H.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:n}){const o=N(),m=I(e,o.proxy.$q),p=v(()=>{const i=e.size!==void 0?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:i[0],height:i[1]}}),c=v(()=>`q-skeleton q-skeleton--${m.value===!0?"dark":"light"} q-skeleton--type-${e.type}`+(e.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(e.square===!0?" q-skeleton--square":"")+(e.bordered===!0?" q-skeleton--bordered":""));return()=>z(e.tag,{class:c.value,style:p.value},U(n.default))}});const J=w({name:"UpdateCard",props:{item:{type:Object,required:!0}},setup(){const e=g("");return{useCache:g(`${G("useCache",!0)}`),imgdata:e}},mounted:function(){F(this.item.manga.thumbnailUrl+"?useCache="+this.useCache).then(e=>{this.imgdata=e})},methods:{async download(e){await this.$api.get(`/api/v1/download/${e.manga.id}/chapter/${e.chapter.index}`)}}});function K(e,n,o,m,p,c){return q((s(),l(b,{clickable:"",class:"q-pa-xs q-ma-sm"},{default:a(()=>[t(S,{to:"/manga/"+e.item.manga.id},{default:a(()=>[t(d,{avatar:""},{default:a(()=>[t(O,{src:e.imgdata,loading:"lazy","spinner-color":"white",style:{height:"93px","aspect-ratio":"225/350",width:"fit-content"},class:"rounded-borders items-center justify-center col-1","no-spinner":""},{default:a(()=>[t(A,{showing:!e.imgdata,color:"primary",style:{padding:"0"}},null,8,["showing"])]),_:1},8,["src"])]),_:1}),t(d,null,{default:a(()=>[t(u,null,{default:a(()=>[_(k(e.item.manga.title),1)]),_:1}),t(u,{caption:""},{default:a(()=>[_(k(e.item.chapter.name),1)]),_:1})]),_:1}),e.item.chapter.downloaded?T("",!0):(s(),l(E,{key:0,round:"",style:{height:"fit-content"},flat:"",icon:"download",class:"flex-right self-center",onClick:n[0]||(n[0]=P(i=>e.download(e.item),["prevent"]))}))]),_:1},8,["to"])]),_:1})),[[x]])}var W=C(J,[["render",K]]);const X=w({name:"UpdatesPage",components:{UpdateCard:W},emits:["set-title"],setup(e,{emit:n}){return n("set-title","Updates"),{updates:g([])}},methods:{myTweak(e){return{height:e?`calc(100vh - ${e}px)`:"100vh"}},async onLoad(e,n){const{data:o}=await this.$api.get(`/api/v1/update/recentChapters/${e}`);o.hasNextPage||this.$refs.infiniteScrol.stop(),this.updates.push(...o.page),n()}}});function Y(e,n,o,m,p,c){const i=D("UpdateCard");return s(),l(j,{"style-fn":e.myTweak,class:"notOflow"},{default:a(()=>[t(V,{ref:"infiniteScrol",offset:e.$q.screen.height,onLoad:e.onLoad},{loading:a(()=>[(s(),h($,null,Q(6,(y,f)=>R("div",{key:f},[q((s(),l(b,{clickable:"",class:"q-pa-xs q-ma-sm"},{default:a(()=>[t(S,null,{default:a(()=>[t(d,{avatar:""},{default:a(()=>[t(r,{height:"93px",style:{height:"93px","aspect-ratio":"225/350"}})]),_:1}),t(d,null,{default:a(()=>[t(u,null,{default:a(()=>[t(r,{type:"text"})]),_:1}),t(u,{caption:""},{default:a(()=>[t(r,{type:"text"})]),_:1})]),_:1}),t(r,{class:"flex-right self-center",type:"circle"})]),_:1})]),_:1})),[[x]])])),64))]),default:a(()=>[(s(!0),h($,null,Q(e.updates,(y,f)=>(s(),h("div",{key:f},[t(i,{item:y},null,8,["item"])]))),128))]),_:1},8,["offset","onLoad"])]),_:1},8,["style-fn"])}var ve=C(X,[["render",Y],["__scopeId","data-v-67553d25"]]);export{ve as default};
