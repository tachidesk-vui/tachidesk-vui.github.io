import{u as B,a as I}from"./use-dark.5a95c9ad.js";import{c as L,h as U}from"./QSpinner.a066f13a.js";import{c as y,h as z,g as N,d as $,r as w,_ as q,y as S,f as s,j as l,k as a,m as t,p as k,t as v,ak as P,n as T,s as D,v as g,x as _,F as Q,u as R}from"./index.e607ebbf.js";import{Q as d,a as m}from"./QItemLabel.bc894da5.js";import{Q as C}from"./QItem.3b00e4c6.js";import{Q as b}from"./QCard.b23e52e7.js";import{Q as V}from"./QInfiniteScroll.fb304dcf.js";import{Q as j}from"./QPage.15fd8730.js";import{R as x}from"./Ripple.e079ce52.js";import{Q as A}from"./QInnerLoading.c515810d.js";import{g as F,Q as O}from"./usefull.2dc78a7a.js";import{Q as E}from"./QBtn.239ac4bd.js";import"./dom.a3995931.js";import"./scroll.d09d2b62.js";import"./use-transition.ff15bca0.js";import"./axios.adfc46d0.js";import"./StoreStuff.8dd7626e.js";import"./getenv.7492fdf7.js";import"./QIcon.872d3216.js";const M=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],G=["wave","pulse","pulse-x","pulse-y","fade","blink","none"];var r=L({name:"QSkeleton",props:{...B,tag:{type:String,default:"div"},type:{type:String,validator:e=>M.includes(e),default:"rect"},animation:{type:String,validator:e=>G.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:n}){const o=N(),p=I(e,o.proxy.$q),u=y(()=>{const i=e.size!==void 0?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:i[0],height:i[1]}}),c=y(()=>`q-skeleton q-skeleton--${p.value===!0?"dark":"light"} q-skeleton--type-${e.type}`+(e.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(e.square===!0?" q-skeleton--square":"")+(e.bordered===!0?" q-skeleton--bordered":""));return()=>z(e.tag,{class:c.value,style:u.value},U(n.default))}});const H=$({name:"UpdateCard",props:{item:{type:Object,required:!0}},setup(){return{imgdata:w("")}},mounted:function(){F(this.item.manga.thumbnailUrl).then(e=>{this.imgdata=e})},methods:{async download(e){await this.$api.get(`/api/v1/download/${e.manga.id}/chapter/${e.chapter.index}`)}}});function J(e,n,o,p,u,c){return S((s(),l(b,{clickable:"",class:"q-pa-xs q-ma-sm"},{default:a(()=>[t(C,{to:"/manga/"+e.item.manga.id},{default:a(()=>[t(d,{avatar:""},{default:a(()=>[t(O,{src:e.imgdata,loading:"lazy","spinner-color":"white",style:{height:"93px","aspect-ratio":"225/350",width:"fit-content"},class:"rounded-borders items-center justify-center col-1","no-spinner":""},{default:a(()=>[t(A,{showing:!e.imgdata,color:"primary",style:{padding:"0"}},null,8,["showing"])]),_:1},8,["src"])]),_:1}),t(d,null,{default:a(()=>[t(m,null,{default:a(()=>[k(v(e.item.manga.title),1)]),_:1}),t(m,{caption:""},{default:a(()=>[k(v(e.item.chapter.name),1)]),_:1})]),_:1}),e.item.chapter.downloaded?T("",!0):(s(),l(E,{key:0,round:"",style:{height:"fit-content"},flat:"",icon:"download",class:"flex-right self-center",onClick:n[0]||(n[0]=P(i=>e.download(e.item),["prevent"]))}))]),_:1},8,["to"])]),_:1})),[[x]])}var K=q(H,[["render",J]]);const W=$({name:"UpdatesPage",components:{UpdateCard:K},emits:["set-title"],setup(e,{emit:n}){return n("set-title","Updates"),{updates:w([])}},methods:{myTweak(e){return{height:e?`calc(100vh - ${e}px)`:"100vh"}},async onLoad(e,n){const{data:o}=await this.$api.get(`/api/v1/update/recentChapters/${e}`);o.hasNextPage||this.$refs.infiniteScrol.stop(),this.updates.push(...o.page),n()}}});function X(e,n,o,p,u,c){const i=D("UpdateCard");return s(),l(j,{"style-fn":e.myTweak,class:"notOflow"},{default:a(()=>[t(V,{ref:"infiniteScrol",offset:e.$q.screen.height,onLoad:e.onLoad},{loading:a(()=>[(s(),g(Q,null,_(6,(h,f)=>R("div",{key:f},[S((s(),l(b,{clickable:"",class:"q-pa-xs q-ma-sm"},{default:a(()=>[t(C,null,{default:a(()=>[t(d,{avatar:""},{default:a(()=>[t(r,{height:"93px",style:{height:"93px","aspect-ratio":"225/350"}})]),_:1}),t(d,null,{default:a(()=>[t(m,null,{default:a(()=>[t(r,{type:"text"})]),_:1}),t(m,{caption:""},{default:a(()=>[t(r,{type:"text"})]),_:1})]),_:1}),t(r,{class:"flex-right self-center",type:"circle"})]),_:1})]),_:1})),[[x]])])),64))]),default:a(()=>[(s(!0),g(Q,null,_(e.updates,(h,f)=>(s(),g("div",{key:f},[t(i,{item:h},null,8,["item"])]))),128))]),_:1},8,["offset","onLoad"])]),_:1},8,["style-fn"])}var ye=q(W,[["render",X],["__scopeId","data-v-3ff262a5"]]);export{ye as default};
