import{Q as L}from"./QIntersection.156f9ced.js";import{Q as S}from"./QList.6e6370e8.js";import{Q}from"./QInnerLoading.e286f2aa.js";import{Q as q}from"./QPage.7936c293.js";import{a as $,u as N}from"./Filters.9dab1c54.js";import{g as B,Q as T}from"./usefull.94d89ac8.js";import{Q as g,a as f}from"./QItemLabel.1ef5a759.js";import{Q as h}from"./QBtn.c5817d19.js";import{Q as F}from"./QItem.0d04f53f.js";import{Q as R}from"./QCard.be381522.js";import{R as V}from"./Ripple.61004137.js";import{storeGet as j}from"./StoreStuff.27a7a11c.js";import{d as _,r as u,_ as k,f as o,j as n,k as s,y as z,u as y,m as r,p as w,t as p,v as l,n as c,al as P,s as U,x as A,F as D}from"./index.057ad32f.js";import"./Intersection.4de8b9c1.js";import"./QSpinner.2de32336.js";import"./use-dark.a3c8939c.js";import"./use-transition.1af90828.js";import"./axios.f19d17fc.js";import"./getenv.7492fdf7.js";import"./QIcon.6be871fb.js";import"./dom.bc5102fa.js";const E=_({name:"SourceCard",props:{source:{type:Object,required:!0}},emits:["reload"],setup(){const e=u(`${j("useCache",!0)}`),t=u("");return{useCache:e,imgdata:t}},watch:{"source.iconUrl"(){this.imgdata="",this.getSetImg()}},mounted:function(){this.getSetImg()},methods:{capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)},langCodeToName:$,getSetImg(){B(this.source.iconUrl+"?useCache="+this.useCache).then(e=>{this.imgdata=e})}}}),x={class:"row content-center col-grow"},G={key:0,style:{color:"red"}},O={class:"flex items-center"};function H(e,t,a,m,d,C){return o(),n(R,{flat:"",class:"q-ma-sm"},{default:s(()=>[z((o(),n(F,{clickable:"",style:{height:"100px"},to:`/sources/${e.source.id}/popular/`},{default:s(()=>[y("div",x,[r(g,{avatar:""},{default:s(()=>[r(T,{src:e.imgdata,loading:"lazy","spinner-color":"white",style:{height:"100px","aspect-ratio":"225/225",width:"fit-content"},class:"rounded-borders items-center justify-center","no-spinner":""},{default:s(()=>[r(Q,{showing:!e.imgdata,color:"primary",class:"bg-transparent"},null,8,["showing"])]),_:1},8,["src"])]),_:1}),r(g,{class:"flex-grow"},{default:s(()=>[r(f,null,{default:s(()=>[w(p(e.capitalizeFirstLetter(e.source.name)),1)]),_:1}),r(f,{caption:""},{default:s(()=>[w(p(e.langCodeToName(e.source.lang))+" ",1),e.source.isNsfw?(o(),l("span",G,"18+")):c("",!0)]),_:1})]),_:1})]),y("div",O,[e.source.supportsLatest?(o(),n(h,{key:0,class:"q-ma-sm",outline:"",color:"blue",label:"latest",to:`/sources/${e.source.id}/latest/`},null,8,["to"])):c("",!0),e.$q.screen.xs?c("",!0):(o(),n(h,{key:1,class:"q-ma-sm",outline:"",color:"blue",label:"browse",to:`/sources/${e.source.id}/popular/`},null,8,["to"]))])]),_:1},8,["to"])),[[V]])]),_:1})}var J=k(E,[["render",H]]);const K=_({name:"SourcesPage",components:{sourcecard:J},emits:["set-title"],setup(e,{emit:t}){t("set-title","Sources");const a=N(),m=u(a.langs);return{list:u([]),langs:m,filters:a,is:P}},computed:{uselist(){return this.list.filter(t=>this.langs.includes(t.lang)).sort((t,a)=>t.lang<a.lang?1:t.lang>a.lang?-1:0)}},created:function(){this.reload()},methods:{myTweak(e){return{height:e?`calc(100vh - ${e}px)`:"100vh"}},reload(){this.$api.get("/api/v1/source/list").then(({data:e})=>{this.list=e,this.filters.setcurrlangs(this.extractLangs(e))})},langCodeToName:$,extractLangs(e){return Array.from(new Set(e.map(t=>t.lang)))}}}),M={key:0,class:"text-h4 q-ml-xl q-my-lg"};function W(e,t,a,m,d,C){const v=U("sourcecard");return o(),n(q,{"style-fn":e.myTweak},{default:s(()=>[r(S,null,{default:s(()=>[(o(!0),l(D,null,A(e.uselist,(i,b)=>(o(),l("div",{key:b},[e.is.deepEqual(e.uselist.find(I=>I.lang==i.lang),i)?(o(),l("div",M,p(e.langCodeToName(i.lang)),1)):c("",!0),r(L,{style:{height:"100px",width:"100%"},class:"flex-shrink"},{default:s(()=>[r(v,{source:i,onReload:e.reload},null,8,["source","onReload"])]),_:2},1024)]))),128))]),_:1}),r(Q,{style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"fit-content",height:"fit-content","background-color":"transparent"},showing:!e.uselist.length,color:"primary"},null,8,["showing"])]),_:1},8,["style-fn"])}var we=k(K,[["render",W]]);export{we as default};
