import{Q as L}from"./QIntersection.16e3c7e8.js";import{Q as S}from"./QList.1c031a76.js";import{Q}from"./QInnerLoading.c2ee7d9e.js";import{Q as q}from"./QPage.fd3498d9.js";import{u as N}from"./Filters.d1cef238.js";import{g as B,Q as T}from"./usefull.5949ebbf.js";import{Q as g,a as f}from"./QItemLabel.43ea2709.js";import{Q as h}from"./QBtn.83cc7836.js";import{Q as F}from"./QItem.ddf44946.js";import{Q as R}from"./QCard.f6a06634.js";import{R as V}from"./Ripple.0063342c.js";import{a as _}from"./language.588b8ace.js";import{d as $,r as u,_ as k,f as o,j as n,k as s,y as j,u as y,m as r,p as w,t as p,v as l,n as c,al as z,s as P,x as U,F as A}from"./index.16a21bb1.js";import"./Intersection.4f2ff861.js";import"./QSpinner.992dc9e3.js";import"./use-dark.3d2c1956.js";import"./use-transition.8cb170ff.js";import"./StoreStuff.3cd89d8c.js";import"./axios.5660c961.js";import"./getenv.7492fdf7.js";import"./QIcon.b4c56408.js";import"./dom.1d14d0d9.js";const D=$({name:"SourceCard",props:{source:{type:Object,required:!0}},emits:["reload"],setup(){return{imgdata:u("")}},watch:{"source.iconUrl"(){this.imgdata="",this.getSetImg()}},mounted:function(){this.getSetImg()},methods:{capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)},langCodeToName:_,getSetImg(){B(this.source.iconUrl).then(e=>{this.imgdata=e})}}}),E={class:"row content-center col-grow"},x={key:0,style:{color:"red"}},O={class:"flex items-center"};function G(e,t,a,m,d,v){return o(),n(R,{flat:"",class:"q-ma-sm"},{default:s(()=>[j((o(),n(F,{clickable:"",style:{height:"100px"},to:`/sources/${e.source.id}/popular/`},{default:s(()=>[y("div",E,[r(g,{avatar:""},{default:s(()=>[r(T,{src:e.imgdata,loading:"lazy","spinner-color":"white",style:{height:"100px","aspect-ratio":"225/225",width:"fit-content"},class:"rounded-borders items-center justify-center","no-spinner":""},{default:s(()=>[r(Q,{showing:!e.imgdata,color:"primary",class:"bg-transparent"},null,8,["showing"])]),_:1},8,["src"])]),_:1}),r(g,{class:"flex-grow"},{default:s(()=>[r(f,null,{default:s(()=>[w(p(e.capitalizeFirstLetter(e.source.name)),1)]),_:1}),r(f,{caption:""},{default:s(()=>[w(p(e.langCodeToName(e.source.lang))+" ",1),e.source.isNsfw?(o(),l("span",x,"18+")):c("",!0)]),_:1})]),_:1})]),y("div",O,[e.source.supportsLatest?(o(),n(h,{key:0,class:"q-ma-sm",outline:"",color:"blue",label:"latest",to:`/sources/${e.source.id}/latest/`},null,8,["to"])):c("",!0),e.$q.screen.xs?c("",!0):(o(),n(h,{key:1,class:"q-ma-sm",outline:"",color:"blue",label:"browse",to:`/sources/${e.source.id}/popular/`},null,8,["to"]))])]),_:1},8,["to"])),[[V]])]),_:1})}var H=k(D,[["render",G]]);const J=$({name:"SourcesPage",components:{sourcecard:H},emits:["set-title"],setup(e,{emit:t}){t("set-title","Sources");const a=N(),m=u(a.langs);return{list:u([]),langs:m,filters:a,is:z}},computed:{uselist(){return this.list.filter(t=>this.langs.includes(t.lang)).sort((t,a)=>t.lang<a.lang?1:t.lang>a.lang?-1:0)}},created:function(){this.reload()},methods:{myTweak(e){return{height:e?`calc(100vh - ${e}px)`:"100vh"}},reload(){this.$api.get("/api/v1/source/list").then(({data:e})=>{this.list=e,this.filters.setcurrlangs(this.extractLangs(e))})},langCodeToName:_,extractLangs(e){return Array.from(new Set(e.map(t=>t.lang)))}}}),K={key:0,class:"text-h4 q-ml-xl q-my-lg"};function M(e,t,a,m,d,v){const b=P("sourcecard");return o(),n(q,{"style-fn":e.myTweak},{default:s(()=>[r(S,null,{default:s(()=>[(o(!0),l(A,null,U(e.uselist,(i,I)=>(o(),l("div",{key:I},[e.is.deepEqual(e.uselist.find(C=>C.lang==i.lang),i)?(o(),l("div",K,p(e.langCodeToName(i.lang)),1)):c("",!0),r(L,{style:{height:"100px",width:"100%"},class:"flex-shrink"},{default:s(()=>[r(b,{source:i,onReload:e.reload},null,8,["source","onReload"])]),_:2},1024)]))),128))]),_:1}),r(Q,{style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"fit-content",height:"fit-content","background-color":"transparent"},showing:!e.uselist.length,color:"primary"},null,8,["showing"])]),_:1},8,["style-fn"])}var we=k(J,[["render",M]]);export{we as default};
